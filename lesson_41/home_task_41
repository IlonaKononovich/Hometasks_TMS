Кейс 2
Анализ популярности товаров (dm_product_popularity)
Цель: Выявить самые продаваемые товары.
Контекст: Мы хотим оптимизировать ассортимент товаров в магазине. Некоторые продукты продаются лучше, другие хуже, и нам нужно понять, что пользуется спросом, чтобы закупать больше популярных товаров и убирать непродаваемые.
Цель: Построить витрину, которая покажет, какие товары чаще покупают, сколько единиц каждого товара продано, какую выручку они приносят и сколько заказов их содержат. Также добавьте среднюю цену товара для анализа изменений цен.
Ожидаемый результат: Таблица dm_product_popularity в PostgreSQL с колонками:
product_id (ID товара),
product_name (название товара),
total_quantity_sold (общее количество проданных единиц),
total_revenue (общая выручка от товара),
order_count (количество заказов с этим товаром)

Дополнительные требования:
- Каждый этап сборки данных должен логироваться в ТГ или почту
- Должно быть несколько слоев данных в DWH (3 минимум)
- Должны быть использованы следующие операторы: PythonOperator, PostgresOperator, TaskGroup
- Должна присутствовать валидация Pydantic
